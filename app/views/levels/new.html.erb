<%
levels = [
  {
    key: "beginner",
    label: "初心者",
    descriptions: [
      "野球の経験なし",
      "「アウト」「ストライク」など基本概念が曖昧",
      "専門用語なしで、例え話や基礎からの説明があると理解しやすい"
    ],
    note: "基礎の基礎から知りたい人向け"
  },
  {
    key: "intermediate",
    label: "中級者",
    descriptions: [
      "テレビやゲームで野球を楽しむことがある",
      "盗塁、四球、ホームランなど基本用語は理解している",
      "観戦ポイントや簡単な戦術補足があると嬉しい"
    ],
    note: "基本はわかるけど、さらに深く楽しみたい人向け"
  },
  {
    key: "advanced",
    label: "上級者",
    descriptions: [
      "野球経験あり、または観戦が趣味",
      "戦術を理解している（エンドラン、バントシフトなど）",
      "チーム事情や戦略背景まで知りたい"
    ],
    note: "プレーや戦術の“背景”まで理解したい人向け"
  }
]
%>

<!-- 理解度選択 / 変更 共通 -->
<div id="level-select" data-mode="<%= @mode %>">
  <div class="container mx-auto py-16">

    <!-- タイトル -->
    <div class="text-center mb-12">
      <h1 class="text-3xl font-bold">
        <% if @mode == :edit %>
          理解度を変更してください
        <% else %>
          あなたの理解度を選択してください
        <% end %>
      </h1>
    </div>

    <!-- カード一覧 -->
    <div class="flex justify-center">
      <div class="grid md:grid-cols-3 gap-10">

        <% levels.each do |level| %>
          <div
            class="card w-96 p-8 shadow hover:bg-blue-50 cursor-pointer relative"
            data-level="<%= level[:key] %>"
          >
            <!-- 見出し -->
            <h3 class="font-bold text-2xl mb-4">
              <%= level[:label] %>
            </h3>

            <!-- 説明リスト -->
            <ul class="text-gray-700 space-y-1 mb-6">
              <% level[:descriptions].each do |text| %>
                <li>・<%= text %></li>
              <% end %>
            </ul>

            <!-- 補足説明 -->
            <p class="text-gray-600 font-medium mb-14">
              <%= level[:note] %>
            </p>

            <!-- 決定ボタン -->
            <%= form_with url: level_path,
                          method: :patch,
                          local: true,
                          data: { turbo: false } do %>

              <%= button_tag type: "submit",
                    name: "level",
                    value: level[:key],
                    class: "
                      decide-button
                      absolute bottom-6 right-6
                      bg-blue-600
                      text-white
                      text-sm
                      px-4 py-2
                      rounded-md
                      shadow
                      hover:bg-blue-700
                      transition
                    " do %>

                <% if @mode == :edit %>
                  この理解度に変更する
                <% else %>
                  この理解度にする
                <% end %>

              <% end %>
            <% end %>
          </div>
        <% end %>

      </div>
    </div>

    <% if @mode == :edit %>
      <div class="text-center mt-16">
        <%= link_to terms_path,
            data: { turbo: false },
            class: "
              inline-flex items-center gap-2
              bg-blue-600 text-white text-sm
              px-4 py-2
              rounded-md shadow
              hover:bg-blue-700
              transition
            " do %>
          検索画面へ進む
          <svg xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5"
              fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 5l7 7-7 7" />
          </svg>
        <% end %>
      </div>
    <% end %>
  </div>
</div>